---
phase: 05-flutter-ui-refactoring
plan: 01
type: execute
depends_on: []
files_modified:
  - mobile/lib/screens/oauth/tesla_login_screen.dart
  - mobile/lib/screens/oauth/audi_login_screen.dart
  - mobile/lib/screens/oauth/vw_group_login_screen.dart
  - mobile/lib/screens/oauth/renault_login_screen.dart
  - mobile/lib/screens/cars_screen.dart
---

<objective>
Extract OAuth WebView login screens from cars_screen.dart into dedicated files.

Purpose: Reduce cars_screen.dart from 2009 lines by extracting ~400 lines of OAuth WebView screens into a dedicated oauth/ directory, improving maintainability and enabling reuse.
Output: Four new OAuth screen files in lib/screens/oauth/, cars_screen.dart reduced by ~400 lines.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/codebase/CONVENTIONS.md

**Prior phase context:**
Phase 4 completed Flutter Provider Split. This phase focuses on UI refactoring.

**Established patterns:**
- Dart files use snake_case naming
- One public class per file typically
- Imports: dart SDK → package imports → relative imports

**Key files:**
@mobile/lib/screens/cars_screen.dart
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create oauth directory and extract Tesla/Audi screens</name>
  <files>mobile/lib/screens/oauth/tesla_login_screen.dart, mobile/lib/screens/oauth/audi_login_screen.dart</files>
  <action>
1. Create directory: mobile/lib/screens/oauth/
2. Create tesla_login_screen.dart:
   - Add required imports (flutter/material.dart, webview_flutter/webview_flutter.dart)
   - Move TeslaLoginScreen and _TeslaLoginScreenState classes from cars_screen.dart (lines 1328-1395)
   - Make TeslaLoginScreen public (it already is)
3. Create audi_login_screen.dart:
   - Add required imports
   - Move AudiLoginScreen and _AudiLoginScreenState classes (lines 1397-1473)
   - Make AudiLoginScreen public (it already is)
  </action>
  <verify>Files created, classes compile without errors: `cd mobile && flutter analyze lib/screens/oauth/`</verify>
  <done>tesla_login_screen.dart and audi_login_screen.dart exist with correct imports and compile</done>
</task>

<task type="auto">
  <name>Task 2: Extract VWGroup and Renault WebView screens</name>
  <files>mobile/lib/screens/oauth/vw_group_login_screen.dart, mobile/lib/screens/oauth/renault_login_screen.dart</files>
  <action>
1. Create vw_group_login_screen.dart:
   - Add required imports (flutter/material.dart, webview_flutter/webview_flutter.dart)
   - Move VWGroupLoginScreen and _VWGroupLoginScreenState classes (lines 1787-1906)
2. Create renault_login_screen.dart:
   - Add required imports
   - Move RenaultLoginScreen and _RenaultLoginScreenState classes (lines 1909-2009)
  </action>
  <verify>Files created, classes compile: `cd mobile && flutter analyze lib/screens/oauth/`</verify>
  <done>vw_group_login_screen.dart and renault_login_screen.dart exist and compile</done>
</task>

<task type="auto">
  <name>Task 3: Update cars_screen.dart imports and remove extracted code</name>
  <files>mobile/lib/screens/cars_screen.dart</files>
  <action>
1. Add imports at top of cars_screen.dart:
   - import 'oauth/tesla_login_screen.dart';
   - import 'oauth/audi_login_screen.dart';
   - import 'oauth/vw_group_login_screen.dart';
   - import 'oauth/renault_login_screen.dart';
2. Remove the extracted classes from cars_screen.dart:
   - Delete TeslaLoginScreen and _TeslaLoginScreenState (lines 1328-1395)
   - Delete AudiLoginScreen and _AudiLoginScreenState (lines 1397-1473)
   - Delete VWGroupLoginScreen and _VWGroupLoginScreenState (lines 1787-1906)
   - Delete RenaultLoginScreen and _RenaultLoginScreenState (lines 1909-2009)
3. Verify all Navigator.push calls to these screens still work (they reference by class name)
  </action>
  <verify>`cd mobile && flutter analyze` passes, app builds: `flutter build ios --no-codesign`</verify>
  <done>cars_screen.dart imports oauth screens, builds successfully, reduced by ~400 lines</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `flutter analyze` passes with no errors in mobile/
- [ ] `flutter build ios --no-codesign` succeeds
- [ ] cars_screen.dart line count reduced from 2009 to ~1600
- [ ] All 4 OAuth screens in mobile/lib/screens/oauth/
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- OAuth screens extracted and functional
- No TypeScript/Dart errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-flutter-ui-refactoring/05-01-SUMMARY.md`
</output>

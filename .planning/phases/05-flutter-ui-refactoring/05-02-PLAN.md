---
phase: 05-flutter-ui-refactoring
plan: 02
type: execute
depends_on: ["05-01"]
files_modified:
  - mobile/lib/widgets/car_widgets.dart
  - mobile/lib/screens/cars_screen.dart
---

<objective>
Extract reusable car widgets from cars_screen.dart into a dedicated widgets file.

Purpose: Further reduce cars_screen.dart by extracting ~300 lines of reusable widgets (_CarCard, _StatChip, _OAuthLoginCard, _RenaultLoginForm), making them public and reusable.
Output: New car_widgets.dart with exported widgets, cars_screen.dart reduced to ~1300 lines.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/codebase/CONVENTIONS.md
@.planning/phases/05-flutter-ui-refactoring/05-01-SUMMARY.md

**Prior plan context:**
05-01 extracted OAuth WebView screens, reducing cars_screen.dart to ~1600 lines.

**Key files:**
@mobile/lib/screens/cars_screen.dart
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create car_widgets.dart with CarCard and StatChip</name>
  <files>mobile/lib/widgets/car_widgets.dart</files>
  <action>
1. Create mobile/lib/widgets/car_widgets.dart
2. Add required imports:
   - flutter/material.dart
   - ../models/car.dart
   - ../l10n/generated/app_localizations.dart
   - ../utils/color_utils.dart
3. Move and rename _CarCard to CarCard (make public):
   - Copy class from cars_screen.dart (lines 107-223)
   - Remove underscore prefix
   - Keep _getCarIcon helper as private function in this file
   - Keep _editCar and _deleteCar methods
4. Move and rename _StatChip to StatChip (make public):
   - Copy class from cars_screen.dart (lines 224-241)
   - Remove underscore prefix
  </action>
  <verify>File compiles: `cd mobile && flutter analyze lib/widgets/car_widgets.dart`</verify>
  <done>car_widgets.dart exists with CarCard and StatChip, compiles without errors</done>
</task>

<task type="auto">
  <name>Task 2: Add OAuth widgets and RenaultLoginForm to car_widgets.dart</name>
  <files>mobile/lib/widgets/car_widgets.dart</files>
  <action>
1. Add to car_widgets.dart:
   - Move and rename _OAuthLoginCard to OAuthLoginCard (lines 1655-1784 in original)
   - Move and rename _RenaultLoginForm to RenaultLoginForm (lines 1476-1652 in original)
2. Add any additional imports needed (none expected - these are pure widgets)
3. Ensure all color constants are included (e.g., _renaultYellow -> renaultYellow or keep private)
  </action>
  <verify>File compiles: `cd mobile && flutter analyze lib/widgets/car_widgets.dart`</verify>
  <done>car_widgets.dart has all 4 widgets (CarCard, StatChip, OAuthLoginCard, RenaultLoginForm)</done>
</task>

<task type="auto">
  <name>Task 3: Update cars_screen.dart to use extracted widgets</name>
  <files>mobile/lib/screens/cars_screen.dart</files>
  <action>
1. Add import at top: import '../widgets/car_widgets.dart';
2. Remove extracted classes from cars_screen.dart:
   - Delete _CarCard class (lines 107-223)
   - Delete _StatChip class (lines 224-241)
   - Delete _OAuthLoginCard class
   - Delete _RenaultLoginForm class
3. Update usages (class names now without underscore):
   - _CarCard -> CarCard
   - _StatChip -> StatChip
   - _OAuthLoginCard -> OAuthLoginCard
   - _RenaultLoginForm -> RenaultLoginForm
4. Keep _getCarIcon in cars_screen.dart if still needed locally, or move to car_widgets.dart
  </action>
  <verify>`cd mobile && flutter analyze` passes, `flutter build ios --no-codesign` succeeds</verify>
  <done>cars_screen.dart uses imported widgets, reduced to ~1300 lines, app builds</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `flutter analyze` passes with no errors
- [ ] `flutter build ios --no-codesign` succeeds
- [ ] cars_screen.dart line count ~1300 (down from ~1600 after 05-01)
- [ ] car_widgets.dart contains 4 public widget classes
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Widgets extracted and reusable
- cars_screen.dart focused on screen logic only
</success_criteria>

<output>
After completion, create `.planning/phases/05-flutter-ui-refactoring/05-02-SUMMARY.md`
</output>
